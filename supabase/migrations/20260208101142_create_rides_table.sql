/*\n  # Create Rides Table\n\n  1. New Tables\n    - `rides`\n      - `id` (uuid, primary key) - Unique identifier for each ride\n      - `user_id` (uuid, not null) - Foreign key to auth.users\n      - `ride_at` (timestamptz, not null) - Timestamp when user rode\n      - `source` (text, not null) - How ride was captured: 'now', 'manual', or 'qr'\n      - `note` (text, nullable) - Optional note (ride number, lane, seat, etc.)\n      - `created_at` (timestamptz, not null) - When record was created\n\n  2. Indexes\n    - Index on (user_id, ride_at desc) for efficient user ride queries\n\n  3. Security\n    - Enable RLS on `rides` table\n    - Add policy for authenticated users to SELECT their own rides\n    - Add policy for authenticated users to INSERT their own rides\n    - Add policy for authenticated users to DELETE their own rides\n*/\n\nCREATE TABLE IF NOT EXISTS rides (\n  id uuid PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id uuid NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  ride_at timestamptz NOT NULL,\n  source text NOT NULL CHECK (source IN ('now', 'manual', 'qr')),\n  note text,\n  created_at timestamptz NOT NULL DEFAULT now()\n);
\n\n-- Create index for efficient queries\nCREATE INDEX IF NOT EXISTS rides_user_ride_at_idx ON rides(user_id, ride_at DESC);
\n\n-- Enable RLS\nALTER TABLE rides ENABLE ROW LEVEL SECURITY;
\n\n-- Policy: Users can read their own rides\nCREATE POLICY "Users can read own rides"\n  ON rides\n  FOR SELECT\n  TO authenticated\n  USING (auth.uid() = user_id);
\n\n-- Policy: Users can insert their own rides\nCREATE POLICY "Users can insert own rides"\n  ON rides\n  FOR INSERT\n  TO authenticated\n  WITH CHECK (auth.uid() = user_id);
\n\n-- Policy: Users can delete their own rides\nCREATE POLICY "Users can delete own rides"\n  ON rides\n  FOR DELETE\n  TO authenticated\n  USING (auth.uid() = user_id);
;
